(function($){$.fn.anchorSlider=function(selector,options){var AS=$.fn.anchorSlider;var $container;var $body=$("html body");var currentIndex=0;var sectionHeights=[];var canScroll=true;if(typeof selector=="string"){$container=$(selector)}else{if(typeof selector=="object"){$container=selector}}options=$.extend({allFullPage:false,firstFullPage:true,fullPageIndex:[],speed:500,enableMouseWheelScrolling:true,loop:true,autoScroll:false,autoScrollTime:3000,anchorClassName:"section",anchors:[],afterSlideLoad:null,},options);init();function init(){initStyle();initLayout();initEvent()}$(window).resize(function(){init()});function initStyle(){$("html, body").css({height:"100%",overflow:"hidden",margin:0});$container.addClass("as-container")}function initEvent(){sectionHeights=[];for(var i=0;i<options.anchors.length;i++){var $pageEle=$("."+options.anchors[i]);sectionHeights.push($pageEle.position().top);if($pageEle.height()>$(window).height()){sectionHeights.push($pageEle.position().top+$pageEle.height()-$(window).height())}$("."+options.anchors[i]).addClass("as-section");$('ul li[data-target="'+options.anchors[i]+'"]').click(function(e){e.preventDefault();var anchor=$(this).attr("data-target");var top=$("."+anchor).position().top;scrollToDest(top)})}if(options.enableMouseWheelScrolling){addmouseWheelHandler()}else{removemouseWheelHandler()}if(options.autoScroll){setAutoScroll()}}function initLayout(){if(options.firstFullPage){setFullPage($container.find("."+options.anchorClassName).eq(0))}if(options.allFullPage){for(var i=0;i<options.anchors.length;i++){setFullPage($container.find("."+options.anchorClassName).eq(i))}}for(var i=0;i<options.fullPageIndex.length;i++){setFullPage($container.find("."+options.anchorClassName).eq(options.fullPageIndex[i]))}}function setAutoScroll(){var timer=setInterval(function(){AS.scrollNext()},options.autoScrollTime)}function afterSlideLoaded(index){$.isFunction(options.afterSlideLoad)&&options.afterSlideLoad(index)}function scrollToDest(top){canScroll=false;$container.stop().animate({top:-top},options.speed,function(){currentIndex=findIndex(sectionHeights,Math.abs(top));afterSlideLoaded(currentIndex);canScroll=true})}function setFullPage(ele){var windowHeight=$(window).height();ele.css({width:"100%",height:windowHeight})}function addmouseWheelHandler(){var prefix="";var _addEventListener;if(window.addEventListener){_addEventListener="addEventListener"}else{_addEventListener="attachEvent";prefix="on"}var support="onwheel" in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";if(support=="DOMMouseScroll"){document[_addEventListener](prefix+"MozMousePixelScroll",mouseWheelHandler,false)}else{document[_addEventListener](prefix+support,mouseWheelHandler,false)}}function removemouseWheelHandler(){if(document.addEventListener){document.removeEventListener("mousewheel",mouseWheelHandler,false);document.removeEventListener("wheel",mouseWheelHandler,false);document.removeEventListener("MozMousePixelScroll",mouseWheelHandler,false)}else{document.detachEvent("onmousewheel",mouseWheelHandler)}}function findIndex(arr,val){for(var i=0;i<arr.length;i++){if(arr[i]==val){return i}}return -1}function mouseWheelHandler(event){event=event||window.event;var delta;if(event.wheelDelta){delta=event.wheelDelta}else{if(event.deltaY){delta=-event.deltaY}}if(delta>0){AS.scrollPrev()}else{AS.scrollNext()}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){callback()}}();AS.scrollTo=function(dest){if(typeof dest=="number"){scrollToDest(top)}else{if(typeof dest=="string"){var top=$(dest).position().top;scrollToDest(top)}}};AS.scrollPrev=function(){if(canScroll&&currentIndex>0){currentIndex-=1;scrollToDest(sectionHeights[currentIndex%sectionHeights.length])}};AS.scrollNext=function(){if(canScroll){if(options.loop){currentIndex+=1;scrollToDest(sectionHeights[currentIndex%sectionHeights.length])}else{if(currentIndex<sectionHeights.length-1){currentIndex+=1;scrollToDest(sectionHeights[currentIndex])}}}}}})(jQuery);